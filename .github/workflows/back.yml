name: Backend Check Pipeline

on:
  workflow_dispatch:

jobs:
  db-check:
    runs-on: ubuntu-latest
    steps:
      - name: DB Check
        run: echo "DB connection OK ✅"

  cache-check:
    runs-on: ubuntu-latest
    needs: db-check
    steps:
      - name: Cache Check
        run: |
          echo "Cache check failed ❌"
          exit 1

  api-check:
    runs-on: ubuntu-latest
    needs: cache-check
    if: always()
    steps:
      - name: API Check
        run: echo "API healthy ✅"

  auth-check:
    runs-on: ubuntu-latest
    needs: api-check
    if: always()
    steps:
      - name: Auth Check
        run: |
          echo "Auth service failed ❌"
          exit 1

  metrics-check:
    runs-on: ubuntu-latest
    needs: auth-check
    if: always()
    steps:
      - name: Metrics Check
        run: echo "Metrics OK ✅"

  notify:
    runs-on: ubuntu-latest
    needs: metrics-check
    if: always()
    steps:
      - name: Notify
        run: echo "Notification sent ✅"
